<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Attenza - Setup Step 2</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0" rel="stylesheet" />

    <style>
        :root {
            /* Palette */
            --bg-body: #F9F8F6;
            --bg-card: #ffffff;
            --brand-main: #6E62E5;
            --brand-subtle: #EEF2FF;
            --text-main: #18181b;
            --text-muted: #71717a;
            --border-light: #E4E4E7;
            --error-red: #ef4444;
            --error-bg: #FEF2F2;

            /* Spacing & Radius */
            --radius-card: 14px;
            --radius-input: 8px; /* Slightly smaller radius for smaller inputs */
            --radius-pill: 100px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
        
        body { 
            background-color: var(--bg-body); 
            color: var(--text-main); 
            min-height: 100vh; 
            display: flex; flex-direction: column; 
        }

        .fade-in { animation: fadeIn 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        button, input { border: none; outline: none; background: none; }

        /* --- CONTAINER --- */
        .container { 
            flex: 1; 
            padding: 16px 20px 140px; 
            max-width: 600px; 
            margin: 0 auto; 
            width: 100%;
        }

        /* --- HEADER --- */
        .step-indicator { font-size: 11px; font-weight: 700; color: var(--brand-main); text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 8px; }
        .progress-track { width: 100%; height: 6px; background: #E4E4E7; border-radius: 10px; overflow: hidden; margin-bottom: 24px; }
        .progress-fill { height: 100%; width: 90%; background: var(--brand-main); border-radius: 10px; }
        .page-title { font-size: 24px; font-weight: 700; color: #09090b; margin-bottom: 8px; letter-spacing: -0.02em; }
        .page-subtitle { font-size: 15px; color: var(--text-muted); line-height: 1.5; margin-bottom: 16px; }

        /* --- TIP --- */
        .tip-banner {
            background-color: #F5F3FF;
            border: 1px dashed #DDD6FE;
            border-radius: 12px;
            padding: 14px 16px;
            display: flex; gap: 12px; align-items: start;
            margin-bottom: 24px;
        }
        .tip-banner .icon { color: #6366F1; font-size: 20px; margin-top: 1px; }
        .tip-banner p { font-size: 13px; line-height: 1.5; color: #4B5563; }
        .tip-banner b { color: #4F46E5; font-weight: 600; }

        /* --- CARD LIST --- */
        .card-list { display: flex; flex-direction: column; gap: 10px; }

        .subject-card {
            background: var(--bg-card);
            border: 1.7px solid var(--border-light);
            border-radius: var(--radius-card);
            /* CHANGED: Reduced padding from 18px to 12px/16px */
            padding: 10px 14px; 
            display: flex;
            align-items: center; 
            justify-content: space-between;
            gap: 12px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.02);
            transition: all 0.2s ease;
        }
        
        .subject-card:focus-within {
            border-color: var(--brand-main);
            box-shadow: 0 4px 12px rgba(110, 98, 229, 0.08);
        }

        .card-content { 
            display: flex; flex-direction: column; 
            gap: 4px; /* Reduced gap inside text area */
            flex: 1; 
            min-width: 0; 
        }
        
        .subject-title { 
            font-size: 14px; 
            font-weight: 600; 
            color: var(--text-main);
            white-space: normal; 
            line-height: 1.3;
        }

        .pct-badge {
            align-self: flex-start;
            font-size: 10px; font-weight: 600;
            padding: 2px 6px; border-radius: 4px;
            background: #F3F4F6; color: #9CA3AF;
        }
        .pct-badge.active { background: var(--brand-subtle); color: var(--brand-main); }
        .pct-badge.error { background: var(--error-bg); color: var(--error-red); }

        /* --- INPUTS --- */
        .input-cluster {
            display: flex; align-items: flex-start; gap: 8px;
            flex-shrink: 0;
        }

        .input-wrapper {
            display: flex; flex-direction: column; align-items: center; 
            gap: 4px; /* CHANGED: Reduced gap between input and label (was 6px) */
        }

        .num-input {
            /* CHANGED: Smaller dimensions */
            width: 50px; 
            height: 40px; /* Reduced height (was 42px) */
            background: #F9F8F6;
            border: 1.7px solid #E4E4E7;
            border-radius: var(--radius-input);
            text-align: center;
            font-size: 14px; font-weight: 600; color: #09090b;
            transition: all 0.2s cubic-bezier(0.2, 0, 0, 1);
            box-shadow: 0 1px 2px rgba(0,0,0,0.03); 
        }
        .num-input::placeholder { color: #D4D4D8; }
        .num-input:focus { 
            border-color: var(--brand-main); 
            box-shadow: 0 0 0 3px rgba(110, 98, 229, 0.15); 
            transform: translateY(-1px);
        }
        .num-input.error { 
            border-color: var(--error-red); 
            background: var(--error-bg); 
            color: var(--error-red);
        }

        .input-label { 
            font-size: 10px; 
            color: var(--text-muted); 
            font-weight: 500; 
            text-transform: none; 
            text-align: center;
            line-height: 1.2;
            white-space: nowrap;
        }

        /* --- ACTION BAR (Width Adjusted for more Screen Edge Space) --- */
        .fab-container {
            position: fixed; bottom: 32px; left: 0; right: 0;
            display: flex; justify-content: center; pointer-events: none; z-index: 100;
        }
        .fab-content {
            background-color: #000; padding: 6px 6px 6px 24px;
            border-radius: var(--radius-pill); display: flex; align-items: center; justify-content: space-between;
            box-shadow: 0 16px 32px -8px rgba(0,0,0,0.3); 
            width: 72%; /* INCREASED SPACE FROM EDGES (was 92%) */
            max-width: 340px; /* Constrained width */
            pointer-events: auto; backdrop-filter: blur(10px);
        }
        .status-msg { font-size: 13px; font-weight: 500; margin-left: -2px; color: #A1A1AA; }
        .status-msg.active { color: #fff; }

        /* --- UPDATED BUTTON (Taller & Narrower) --- */
        .btn-primary {
            background-color: #fff; color: #000; 
            padding: 14px 20px; /* INCREASED HEIGHT, REDUCED WIDTH */
            border-radius: var(--radius-pill); font-size: 15px; font-weight: 600; 
            cursor: pointer; transition: all 0.2s ease;
            line-height: 1;
        }
        .btn-primary.save { background-color: #ffffff; color: #000; }
    </style>
</head>

<body>

    <div class="container fade-in">
        <div class="step-indicator">Step 2 of 2</div>
        <div class="progress-track"><div class="progress-fill"></div></div>

        <h1 class="page-title">Past Attendance</h1>
        <p class="page-subtitle">Starting mid-session? Enter your past records to sync the tracker.</p>

        <div class="tip-banner">
            <span class="material-symbols-rounded icon">lightbulb</span>
            <p>You can find these numbers on your <b>college portal</b>, check with your <b>HOD</b>, or enter a rough estimate.</p>
        </div>

        <div id="cardsList" class="card-list"></div>
    </div>

    <div class="fab-container">
        <div class="fab-content">
            <span class="status-msg" id="statusText">No past attendance?</span>
            <button class="btn-primary" id="actionBtn" onclick="handleAction()">Skip step</button>
        </div>
    </div>

    <script>
        // MOCK DATA
        const subjects = [
            "Financial Accounting", 
            "Business Law & Ethics", 
            "Micro Economics",
            "Business Statistics & Mathematics"
        ];

        const listContainer = document.getElementById('cardsList');
        const actionBtn = document.getElementById('actionBtn');
        const statusText = document.getElementById('statusText');
        
        let subjectData = {};

        function renderCards() {
            listContainer.innerHTML = '';
            
            subjects.forEach((sub, index) => {
                const id = `sub-${index}`;
                subjectData[id] = { total: 0, attended: 0, touched: false };

                const card = document.createElement('div');
                card.className = 'subject-card';
                card.innerHTML = `
                    <div class="card-content">
                        <span class="subject-title">${sub}</span>
                        <span class="pct-badge" id="badge-${id}">0%</span>
                    </div>
                    
                    <div class="input-cluster">
                        <div class="input-wrapper">
                            <input type="tel" class="num-input" id="total-${id}" placeholder="0" 
                                oninput="updateCalc('${id}')" onclick="this.select()">
                            <span class="input-label">Total<br>classes</span>
                        </div>

                        <div class="input-wrapper">
                            <input type="tel" class="num-input" id="attended-${id}" placeholder="0" 
                                oninput="updateCalc('${id}')" onclick="this.select()">
                            <span class="input-label">Attended<br>classes</span>
                        </div>
                    </div>
                `;
                listContainer.appendChild(card);
            });
        }

        function updateCalc(id) {
            const totalEl = document.getElementById(`total-${id}`);
            const attendedEl = document.getElementById(`attended-${id}`);
            const badge = document.getElementById(`badge-${id}`);

            const total = parseInt(totalEl.value) || 0;
            const attended = parseInt(attendedEl.value) || 0;

            subjectData[id].touched = (totalEl.value !== "" || attendedEl.value !== "");
            subjectData[id].total = total;
            subjectData[id].attended = attended;

            if (attended > total && total > 0) {
                attendedEl.classList.add('error');
                badge.className = "pct-badge error";
                badge.innerText = "Error";
            } else {
                attendedEl.classList.remove('error');
                if (total > 0) {
                    const pct = Math.round((attended / total) * 100);
                    badge.className = "pct-badge active";
                    badge.innerText = `${pct}%`;
                } else {
                    badge.className = "pct-badge";
                    badge.innerText = "0%";
                }
            }
            updateActionBar();
        }

        function updateActionBar() {
            const validEntries = Object.values(subjectData).filter(d => d.touched && d.total > 0).length;
            const anyInput = Object.values(subjectData).some(d => d.touched);

            if (anyInput) {
                statusText.innerText = validEntries > 0 
                    ? `${validEntries} subject${validEntries !== 1 ? 's' : ''} updated` 
                    : "Entering data...";
                statusText.classList.add('active');
                actionBtn.innerText = "Save";
                actionBtn.classList.add('save');
            } else {
                statusText.innerText = "No past attendance?";
                statusText.classList.remove('active');
                actionBtn.innerText = "Skip";
                actionBtn.classList.remove('save');
            }
        }

        function handleAction() {
            if(actionBtn.classList.contains('save')) {
                let hasErrors = false;
                Object.values(subjectData).forEach(d => { if(d.attended > d.total) hasErrors = true; });
                
                if(hasErrors) {
                    alert("Attended classes cannot be more than Total.");
                } else {
                    console.log("Saving:", subjectData);
                    alert("Saved!");
                }
            } else {
                alert("Skipping Step 2...");
            }
        }

        renderCards();
    </script>
</body>
</html>

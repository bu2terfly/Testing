<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Attenza - Setup Step 1</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0" rel="stylesheet" />

    <style>
        /* --- VARIABLES (Matched to your Menu Design) --- */
        :root {
            --bg-body: #F9F8F6;
            --bg-white: #ffffff;
            --text-main: #18181b;
            --text-muted: #71717a;
            --text-light: #9ca3af;
            
            --brand-purple: #6E62E5;
            --brand-purple-light: rgba(110, 98, 229, 0.08);
            --brand-purple-hover: rgba(110, 98, 229, 0.15);
            
            --border-color: #f3f4f6;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-float: 0 20px 40px -12px rgba(0, 0, 0, 0.12);
            
            --radius-xl: 16px;
            --radius-lg: 12px;
            --radius-pill: 100px;
        }

        /* --- GLOBAL RESET --- */
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background-color: var(--bg-body); color: var(--text-main); min-height: 100vh; display: flex; flex-direction: column; }
        button, input { border: none; outline: none; background: none; }
        
        /* --- UTILITY ANIMATIONS --- */
        .fade-in { animation: fadeIn 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .scale-pop { animation: pop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes pop { 0% { transform: scale(0.95); } 50% { transform: scale(1.02); } 100% { transform: scale(1); } }

        /* --- LAYOUT CONTAINERS --- */
        .container-main { 
            flex: 1; 
            padding: 20px 20px 100px 20px; /* Bottom padding for sticky footer */
            max-width: 600px;
            margin: 0 auto;
            width: 100%;
        }

        /* --- NAV HEADER --- */
        .nav-header {
            display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;
        }
        .nav-btn {
            width: 40px; height: 40px; border-radius: 50%; background: var(--bg-white);
            border: 1px solid var(--border-color); color: var(--text-main);
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; transition: background 0.2s;
            box-shadow: var(--shadow-sm);
        }
        .nav-btn:active { transform: scale(0.95); }

        /* --- PROGRESS BAR --- */
        .progress-wrapper { margin-bottom: 32px; }
        .step-text {
            font-size: 11px; font-weight: 700; color: var(--brand-purple);
            text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 8px;
        }
        .progress-track {
            width: 100%; height: 6px; background: #E4E4E7; border-radius: 10px; overflow: hidden;
        }
        .progress-fill {
            height: 100%; width: 33%; background: var(--brand-purple); border-radius: 10px;
        }

        /* --- PROFILE CARD (EXACT MATCH) --- */
        .profile-card {
            display: flex; gap: 16px; margin-bottom: 32px; align-items: flex-start;
        }
        .profile-img {
            width: 65px; height: 65px; border-radius: var(--radius-xl);
            object-fit: cover; border: 1px solid white; box-shadow: var(--shadow-sm); flex-shrink: 0;
        }
        .profile-info {
            height: 65px; display: flex; flex-direction: column; justify-content: space-between;
            padding: 2px 0; width: 100%; overflow: hidden; position: relative;
        }
        .profile-name {
            font-size: 18px; font-weight: 700; line-height: 1; white-space: nowrap;
            overflow: hidden; text-overflow: ellipsis; padding-right: 20px;
        }
        .profile-email {
            font-size: 12px; font-weight: 500; color: var(--text-muted);
            white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
        }
        .profile-pills { display: flex; gap: 8px; align-items: center; }
        .pill {
            padding: 2.5px 8px; border-radius: 6px; font-size: 10px;
            font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em;
        }
        .pill-purple {
            background: rgba(110, 98, 229, 0.1); border: 1px solid rgba(110, 98, 229, 0.1);
            color: var(--brand-purple);
        }
        .edit-icon {
            position: absolute; bottom: 4px; right: 0; width: 25px; height: 25px;
            cursor: pointer; color: #18181b; transition: color 0.2s;
        }
        .edit-icon:hover { color: var(--brand-purple); }

        /* --- CONTEXT HEADER --- */
        .context-header { margin-bottom: 20px; }
        .context-title { font-size: 24px; font-weight: 800; letter-spacing: -0.5px; margin-bottom: 6px; color: var(--text-main); }
        .context-sub { font-size: 14px; color: var(--text-muted); line-height: 1.5; }

        /* --- SEARCH INPUT --- */
        .search-container { position: relative; width: 100%; margin-bottom: 24px; }
        .search-icon {
            position: absolute; left: 16px; top: 50%; transform: translateY(-50%);
            color: var(--text-light); font-size: 22px;
        }
        .search-input {
            width: 100%; background-color: var(--bg-white);
            padding: 16px 16px 16px 48px; border-radius: var(--radius-lg);
            font-size: 15px; font-weight: 500; box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color); transition: all 0.2s;
        }
        .search-input::placeholder { color: var(--text-light); }
        .search-input:focus { 
            box-shadow: 0 0 0 3px var(--brand-purple-light); 
            border-color: var(--brand-purple); 
        }

        /* --- PILL GRID --- */
        .pill-grid {
            display: flex; flex-wrap: wrap; gap: 10px;
        }
        
        /* The Tactile Pill Component */
        .subject-pill {
            display: inline-flex; align-items: center; gap: 8px;
            padding: 10px 16px;
            background: var(--bg-white);
            border: 1px solid #e4e4e7;
            border-radius: var(--radius-pill);
            cursor: pointer;
            transition: all 0.2s ease;
            user-select: none;
        }
        
        .pill-text { font-size: 14px; font-weight: 600; color: var(--text-main); }
        
        .pill-icon { 
            font-size: 18px; color: var(--text-light); transition: color 0.2s; 
        }

        /* Pill Interactions */
        .subject-pill:hover { border-color: #d4d4d8; background: #fafafa; }
        .subject-pill:active { transform: scale(0.96); }

        /* Selected State */
        .subject-pill.active {
            background: var(--brand-purple-light);
            border-color: var(--brand-purple);
        }
        .subject-pill.active .pill-text { color: var(--brand-purple); }
        .subject-pill.active .pill-icon { color: var(--brand-purple); }

        /* Create Mode Specifics (Subtle distinction before clicking) */
        .subject-pill.create-mode {
            border: 1px dashed var(--text-muted);
            background: transparent;
        }
        .subject-pill.create-mode .pill-text { color: var(--text-main); }
        .subject-pill.create-mode .pill-icon { color: var(--text-main); }

        /* --- STICKY FOOTER --- */
        .footer-fixed {
            position: fixed; bottom: 0; left: 0; width: 100%;
            padding: 20px;
            background: linear-gradient(to top, var(--bg-body) 80%, rgba(249, 248, 246, 0));
            display: flex; justify-content: center;
            pointer-events: none; /* Let clicks pass through gradient area */
        }
        
        .btn-continue {
            pointer-events: auto;
            width: 100%; max-width: 600px;
            background: var(--text-main); color: white;
            height: 54px; border-radius: var(--radius-xl);
            font-size: 16px; font-weight: 600;
            display: flex; align-items: center; justify-content: center; gap: 8px;
            box-shadow: var(--shadow-float);
            transition: all 0.2s; opacity: 1; transform: translateY(0);
        }
        
        .btn-continue:active { transform: scale(0.98); }
        
        /* Disabled State */
        .btn-continue.disabled {
            opacity: 0.5; cursor: not-allowed; background: #d4d4d8; box-shadow: none; color: #a1a1aa;
        }

    </style>
</head>

<body>

    <div class="container-main fade-in">
        
        <div class="nav-header">
            <button class="nav-btn" onclick="window.history.back()">
                <span class="material-symbols-rounded">arrow_back</span>
            </button>
            <button class="nav-btn">
                <span class="material-symbols-rounded" style="color: var(--brand-purple);">help</span>
            </button>
        </div>

        <div class="progress-wrapper">
            <div class="step-text">Step 1 of 3</div>
            <div class="progress-track">
                <div class="progress-fill"></div>
            </div>
        </div>

        <div class="profile-card">
            <img src="https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?ixlib=rb-1.2.1&auto=format&fit=crop&w=800&q=80" 
                 class="profile-img" alt="Profile">
            
            <div class="profile-info">
                <h2 class="profile-name">Johnathan Doe</h2>
                <p class="profile-email">john.doe23@university.edu</p>
                
                <div class="profile-pills">
                    <span class="pill pill-purple">Roll - 234</span>
                    <span class="pill pill-purple">B.Com 1st Sem</span>
                </div>

                <svg xmlns="http://www.w3.org/2000/svg" 
                     viewBox="0 0 24 24" 
                     fill="none" 
                     stroke="currentColor" 
                     stroke-width="2" 
                     stroke-linecap="round" 
                     stroke-linejoin="round" 
                     class="edit-icon">  
                    <path stroke="none" d="M0 0h24v24H0z" fill="none"/>  
                    <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />  
                    <path d="M13.5 6.5l4 4" />  
                    <path d="M16 21l5 -5" />  
                    <path d="M21 21v.01" />  
                    <path d="M16 16v.01" />  
                </svg> 
            </div>
        </div>

        <div class="context-header">
            <h1 class="context-title">Choose your subjects</h1>
            <p class="context-sub">Select the subjects you attend from the list below, or type to create new ones.</p>
        </div>

        <div class="search-container">
            <span class="material-symbols-rounded search-icon">search</span>
            <input type="text" id="subjectInput" placeholder="Search or create a new subject..." class="search-input" oninput="handleSearch()">
        </div>

        <div id="gridContainer" class="pill-grid">
            </div>

    </div>

    <div class="footer-fixed">
        <button id="continueBtn" class="btn-continue disabled">
            <span>Continue</span>
            <span class="material-symbols-rounded">arrow_forward</span>
        </button>
    </div>

    <script>
        // --- CONFIGURATION ---
        // Simulating fetched subjects based on user's class (B.Com)
        const fetchedSubjects = [
            "Financial Accounting", 
            "Business Law", 
            "Micro Economics", 
            "Communicative English",
            "Business Stats",
            "Cost Accounting"
        ];

        // State Management
        let selectedSubjects = new Set();
        let customSubjects = new Set(); // To track which ones were created manually

        // --- DOM ELEMENTS ---
        const grid = document.getElementById('gridContainer');
        const input = document.getElementById('subjectInput');
        const btn = document.getElementById('continueBtn');

        // --- INITIAL RENDER ---
        renderGrid();

        // --- LOGIC ---
        function handleSearch() {
            renderGrid(input.value);
        }

        function renderGrid(query = "") {
            grid.innerHTML = "";
            const q = query.toLowerCase().trim();
            
            // 1. Filter fetched subjects
            const matches = fetchedSubjects.filter(sub => sub.toLowerCase().includes(q));
            
            // 2. Check exact match to decide if we show "Create" option
            const exactMatchFound = matches.some(sub => sub.toLowerCase() === q);
            const isSelectedCustom = customSubjects.has(input.value.trim()); // Case sensitive for storage

            // RENDER: Fetched Matches
            matches.forEach(name => {
                grid.appendChild(createPill(name, false));
            });

            // RENDER: Already Created Custom Subjects (that match query)
            customSubjects.forEach(name => {
                if (name.toLowerCase().includes(q) && !matches.includes(name)) {
                    grid.appendChild(createPill(name, false)); // false because it's already "created" in memory
                }
            });

            // RENDER: "Create" Button (Only if typing, no exact match, and not already created)
            if (q.length > 0 && !exactMatchFound && !customSubjects.has(input.value.trim())) {
                const createName = input.value.trim();
                grid.appendChild(createPill(createName, true)); // true = is creation mode
            }
        }

        function createPill(name, isCreationMode) {
            const el = document.createElement('div');
            const isSelected = selectedSubjects.has(name);
            
            // Base Class
            el.className = 'subject-pill scale-pop';
            
            // State Classes
            if (isSelected) {
                el.classList.add('active');
            }
            if (isCreationMode && !isSelected) {
                el.classList.add('create-mode');
            }

            // Icons
            let iconName = 'add';
            if (isSelected) iconName = 'check';
            
            // Label Text
            let labelText = name;
            if (isCreationMode && !isSelected) labelText = `Create "${name}"`;

            el.innerHTML = `
                <span class="pill-text">${labelText}</span>
                <span class="material-symbols-rounded pill-icon">${iconName}</span>
            `;

            // Interaction
            el.onclick = () => {
                if (isCreationMode) {
                    // Logic: Add to custom list, select it, clear input
                    customSubjects.add(name);
                    selectedSubjects.add(name);
                    input.value = ""; // Clear input for seamless feeling
                    handleSearch(); // Re-render full list
                } else {
                    // Logic: Toggle selection
                    if (selectedSubjects.has(name)) {
                        selectedSubjects.delete(name);
                    } else {
                        selectedSubjects.add(name);
                    }
                    handleSearch(); // Re-render to update state
                }
                updateButton();
            };

            return el;
        }

        function updateButton() {
            if (selectedSubjects.size > 0) {
                btn.classList.remove('disabled');
                btn.innerHTML = `<span>Continue (${selectedSubjects.size})</span><span class="material-symbols-rounded">arrow_forward</span>`;
                // Add click event listener for next step here if needed
                btn.onclick = () => alert("Proceed to Step 2");
            } else {
                btn.classList.add('disabled');
                btn.innerHTML = `<span>Continue</span><span class="material-symbols-rounded">arrow_forward</span>`;
                btn.onclick = null;
            }
        }

    </script>
</body>
</html>

